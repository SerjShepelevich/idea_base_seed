#!/usr/bin/env python3
"""Apply formatting to idea_base_seed docs in-place.

Overwrites:
- docs/IDEAS.md
- docs/DECISIONS.md
- docs/ideas/index.json
- docs/ideas/cards/IDEA-0001..0009.md

Usage:
1) Run on a git branch.
2) Review `git diff`.
"""
from __future__ import annotations

from pathlib import Path
from typing import Dict

FILES: Dict[str, str] = {
  "docs/IDEAS.md": "# База идей (seed)\n\nЗаготовка общей базы идей по концепции навыков (skill-packs) и архитектуре агента.\n\n## Как пользоваться\n\n- Карточки: `docs/ideas/cards/`\n- Индекс для поиска/фильтрации: `docs/ideas/index.json`\n- Принятие в проекты: фиксировать в `docs/DECISIONS.md` и `skills.lock.yaml` проекта\n\n## Текущий набор идей\n\n- **IDEA-0001** — Один универсальный агент, много навыков\n- **IDEA-0002** — Навык как организованная папка файлов\n- **IDEA-0003** — Прозрачные скрипты вместо «чёрных ящиков»\n- **IDEA-0004** — Прогрессивное раскрытие контента навыка\n- **IDEA-0005** — Версионируемая экспертиза (git как память навыков)\n- **IDEA-0006** — Три класса навыков: базовые, 3rd-party, корпоративные\n- **IDEA-0007** — Модульная архитектура агента: loop + runtime + MCP + skills\n- **IDEA-0008** — Непрерывное улучшение через сохранение процедур\n- **IDEA-0009** — CPU/OS/Apps: модель как CPU, runtime как ОС, навыки как приложения\n",
  "docs/DECISIONS.md": "# Журнал решений (seed)\n\n## Принципы\n\n- Идеи живут как артефакты в git (а не в «памяти чата»).\n- Поиск навыков разрешён, но принятие всегда фиксируется (suggest → pin → use).\n- Навык без теста и без манифеста целостности считается «черновиком».\n\n## Решения (TBD)\n\n- Где живёт skill-registry: отдельный репозиторий или подпапка в монорепо.\n- Политика прав (permissions) по умолчанию: read-only; запрет network/system, пока явно не разрешено.\n",
  "docs/ideas/index.json": "{\n  \"ideas\": [\n    {\n      \"id\": \"IDEA-0001\",\n      \"title\": \"Один универсальный агент, много навыков\",\n      \"status\": \"validated\",\n      \"tags\": [\n        \"skills\",\n        \"architecture\",\n        \"scaling\"\n      ],\n      \"related_skills\": [\n        \"skill_registry\",\n        \"skillctl\",\n        \"project_analyzer\"\n      ],\n      \"source\": \"video_transcript.txt\"\n    },\n    {\n      \"id\": \"IDEA-0002\",\n      \"title\": \"Навык как организованная папка файлов\",\n      \"status\": \"validated\",\n      \"tags\": [\n        \"skills\",\n        \"packaging\",\n        \"procedural-knowledge\"\n      ],\n      \"related_skills\": [\n        \"template_skillpack\"\n      ],\n      \"source\": \"video_transcript.txt\"\n    },\n    {\n      \"id\": \"IDEA-0003\",\n      \"title\": \"Прозрачные скрипты вместо «чёрных ящиков»\",\n      \"status\": \"validated\",\n      \"tags\": [\n        \"transparency\",\n        \"debuggability\",\n        \"maintenance\"\n      ],\n      \"related_skills\": [\n        \"permissions_policy\",\n        \"verify_manifest\"\n      ],\n      \"source\": \"video_transcript.txt\"\n    },\n    {\n      \"id\": \"IDEA-0004\",\n      \"title\": \"Прогрессивное раскрытие контента навыка\",\n      \"status\": \"validated\",\n      \"tags\": [\n        \"context\",\n        \"scaling\",\n        \"ux\"\n      ],\n      \"related_skills\": [\n        \"registry_index\",\n        \"skill_metadata_schema\"\n      ],\n      \"source\": \"video_transcript.txt\"\n    },\n    {\n      \"id\": \"IDEA-0005\",\n      \"title\": \"Версионируемая экспертиза (git как память навыков)\",\n      \"status\": \"validated\",\n      \"tags\": [\n        \"git\",\n        \"reproducibility\",\n        \"governance\"\n      ],\n      \"related_skills\": [\n        \"release_manifest\",\n        \"sha256_policy\",\n        \"smoke_tests\"\n      ],\n      \"source\": \"video_transcript.txt\"\n    },\n    {\n      \"id\": \"IDEA-0006\",\n      \"title\": \"Три класса навыков: базовые, 3rd-party, корпоративные\",\n      \"status\": \"validated\",\n      \"tags\": [\n        \"taxonomy\",\n        \"ecosystem\",\n        \"governance\"\n      ],\n      \"related_skills\": [\n        \"registry_taxonomy\"\n      ],\n      \"source\": \"video_transcript.txt\"\n    },\n    {\n      \"id\": \"IDEA-0007\",\n      \"title\": \"Модульная архитектура агента: loop + runtime + MCP + skills\",\n      \"status\": \"validated\",\n      \"tags\": [\n        \"architecture\",\n        \"agent-systems\",\n        \"mcp\"\n      ],\n      \"related_skills\": [\n        \"runtime_sandbox\",\n        \"mcp_connectors\",\n        \"skillpacks\"\n      ],\n      \"source\": \"video_transcript.txt\"\n    },\n    {\n      \"id\": \"IDEA-0008\",\n      \"title\": \"Непрерывное улучшение через сохранение процедур\",\n      \"status\": \"validated\",\n      \"tags\": [\n        \"continuous-improvement\",\n        \"knowledge-capture\"\n      ],\n      \"related_skills\": [\n        \"skill_creator_meta\",\n        \"quality_gate\"\n      ],\n      \"source\": \"video_transcript.txt\"\n    },\n    {\n      \"id\": \"IDEA-0009\",\n      \"title\": \"CPU/OS/Apps: модель как CPU, runtime как ОС, навыки как приложения\",\n      \"status\": \"validated\",\n      \"tags\": [\n        \"metaphor\",\n        \"communication\"\n      ],\n      \"related_skills\": [\n        \"idea_base_explainer\"\n      ],\n      \"source\": \"video_transcript.txt\"\n    }\n  ]\n}\n",
  "docs/ideas/cards/IDEA-0001.md": "# IDEA-0001: Один универсальный агент, много навыков\n\n## Суть\n\nВместо множества узких агентов — один универсальный агент, а специализация достигается подключаемыми навыками (skill-packs).\n\n## Зачем\n\nУзкие агенты плохо масштабируются и превращаются в зоопарк; навыки компонуются и переиспользуются.\n\n## Когда применять\n\n- Когда задачи разноплановые, но среда исполнения одинакова (код/файлы/API).\n- Когда нужно переносить опыт между проектами.\n\n## Когда НЕ применять\n\n- Если задача одноразовая и дешевле написать скрипт без поддержки.\n- Если нет дисциплины версий/тестов — библиотека станет свалкой.\n\n## Связанные навыки (skillpacks)\n\n- skill_registry\n- skillctl\n- project_analyzer\n\n## Статус\n\nvalidated\n\n## Теги\n\nskills, architecture, scaling\n\n## Источник\n\nvideo_transcript.txt\n",
  "docs/ideas/cards/IDEA-0002.md": "# IDEA-0002: Навык как организованная папка файлов\n\n## Суть\n\nНавык — организованная коллекция файлов: инструкции, примеры и (важно) исполняемые скрипты.\n\n## Зачем\n\nОвеществляет процедурное знание; его можно переносить, проверять, версионировать.\n\n## Когда применять\n\n- Когда повторяется один и тот же workflow (анализ, генерация, форматирование, конвертация).\n\n## Когда НЕ применять\n\n- Если содержимое без структуры и метаданных — это свалка, а не навык.\n\n## Связанные навыки (skillpacks)\n\n- template_skillpack\n\n## Статус\n\nvalidated\n\n## Теги\n\nskills, packaging, procedural-knowledge\n\n## Источник\n\nvideo_transcript.txt\n",
  "docs/ideas/cards/IDEA-0003.md": "# IDEA-0003: Прозрачные скрипты вместо «чёрных ящиков»\n\n## Суть\n\nСкрипты навыка — прозрачный код: его можно читать, диагностировать и чинить при изменении API/форматов.\n\n## Зачем\n\nВместо тупика на ошибке — диагностика + локальный фикс + повтор.\n\n## Когда применять\n\n- Когда инструменты/API меняются, а workflow должен жить годами.\n\n## Когда НЕ применять\n\n- Если правки могут навредить внешним системам — нужен permission-слой и запреты по умолчанию.\n\n## Связанные навыки (skillpacks)\n\n- permissions_policy\n- verify_manifest\n\n## Статус\n\nvalidated\n\n## Теги\n\ntransparency, debuggability, maintenance\n\n## Источник\n\nvideo_transcript.txt\n",
  "docs/ideas/cards/IDEA-0004.md": "# IDEA-0004: Прогрессивное раскрытие контента навыка\n\n## Суть\n\nВ контекст грузятся только метаданные навыков, а подробный SkillMD/код — только после выбора конкретного навыка.\n\n## Зачем\n\nМасштабирует библиотеку до сотен/тысяч навыков без перегруза окна контекста.\n\n## Когда применять\n\n- Когда библиотека большая и нужен быстрый поиск и точечная загрузка.\n\n## Когда НЕ применять\n\n- Если метаданные неточны — выбор будет неверным. Нужны теги/сигналы/совместимость.\n\n## Связанные навыки (skillpacks)\n\n- registry_index\n- skill_metadata_schema\n\n## Статус\n\nvalidated\n\n## Теги\n\ncontext, scaling, ux\n\n## Источник\n\nvideo_transcript.txt\n",
  "docs/ideas/cards/IDEA-0005.md": "# IDEA-0005: Версионируемая экспертиза (git как память навыков)\n\n## Суть\n\nЭкспертиза — программный артефакт: git-история, откаты, ветки, ревью, обмен zip-архивом.\n\n## Зачем\n\nДетерминизм, воспроизводимость, контроль качества, аудит изменений.\n\n## Когда применять\n\n- Когда важно знать «кто/когда/зачем» поменял скрипт/правила.\n\n## Когда НЕ применять\n\n- Если нет тестов и манифеста целостности — версии не гарантируют качество.\n\n## Связанные навыки (skillpacks)\n\n- release_manifest\n- sha256_policy\n- smoke_tests\n\n## Статус\n\nvalidated\n\n## Теги\n\ngit, reproducibility, governance\n\n## Источник\n\nvideo_transcript.txt\n",
  "docs/ideas/cards/IDEA-0006.md": "# IDEA-0006: Три класса навыков: базовые, 3rd-party, корпоративные\n\n## Суть\n\nНавыки бывают: (1) базовые фундаментальные, (2) от поставщиков софта, (3) корпоративные процессы/гайдлайны.\n\n## Зачем\n\nУпрощает организацию библиотеки: категории, владельцы, ожидания по поддержке.\n\n## Когда применять\n\n- Когда строите registry: нужны owner, статус поддержки, SLA.\n\n## Когда НЕ применять\n\n- Если смешать всё без owner/поддержки — библиотека деградирует.\n\n## Связанные навыки (skillpacks)\n\n- registry_taxonomy\n\n## Статус\n\nvalidated\n\n## Теги\n\ntaxonomy, ecosystem, governance\n\n## Источник\n\nvideo_transcript.txt\n",
  "docs/ideas/cards/IDEA-0007.md": "# IDEA-0007: Модульная архитектура агента: loop + runtime + MCP + skills\n\n## Суть\n\nАгент как система: цикл рассуждения, песочница исполнения, шлюз к инструментам (MCP/плагины), библиотека навыков.\n\n## Зачем\n\nРазделяет ответственность: мышление ≠ выполнение ≠ доступ к данным ≠ экспертиза.\n\n## Когда применять\n\n- Когда проектируете оркестратор/сервис вокруг агента.\n\n## Когда НЕ применять\n\n- Если всё смешать — сложно тестировать и ограничивать права.\n\n## Связанные навыки (skillpacks)\n\n- runtime_sandbox\n- mcp_connectors\n- skillpacks\n\n## Статус\n\nvalidated\n\n## Теги\n\narchitecture, agent-systems, mcp\n\n## Источник\n\nvideo_transcript.txt\n",
  "docs/ideas/cards/IDEA-0008.md": "# IDEA-0008: Непрерывное улучшение через сохранение процедур\n\n## Суть\n\nЛюбой удачный workflow/скрипт, созданный в ходе работы, сохраняется как новый навык и переиспользуется дальше.\n\n## Зачем\n\n«30-й день лучше 1-го» достигается накоплением проверенных процедур, а не магической памятью модели.\n\n## Когда применять\n\n- Когда видите повторяемый паттерн — вынести в skill-pack.\n\n## Когда НЕ применять\n\n- Если сохранять всё подряд — шум. Нужен порог полезности и QA.\n\n## Связанные навыки (skillpacks)\n\n- skill_creator_meta\n- quality_gate\n\n## Статус\n\nvalidated\n\n## Теги\n\ncontinuous-improvement, knowledge-capture\n\n## Источник\n\nvideo_transcript.txt\n",
  "docs/ideas/cards/IDEA-0009.md": "# IDEA-0009: CPU/OS/Apps: модель как CPU, runtime как ОС, навыки как приложения\n\n## Суть\n\nМодель — мощный CPU, runtime — ОС, навыки — приложения, которые дают прикладную ценность и пишутся многими людьми.\n\n## Зачем\n\nСмещает фокус с «идеального агента» на «экосистему приложений/навыков».\n\n## Когда применять\n\n- Когда нужно объяснить концепцию команде/стейкхолдерам.\n\n## Когда НЕ применять\n\n- Если метафора подменяет инженерные требования: тесты/права/версии всё равно нужны.\n\n## Связанные навыки (skillpacks)\n\n- idea_base_explainer\n\n## Статус\n\nvalidated\n\n## Теги\n\nmetaphor, communication\n\n## Источник\n\nvideo_transcript.txt\n"
}

def main() -> None:
    repo = Path('.').resolve()
    (repo / 'docs' / 'ideas' / 'cards').mkdir(parents=True, exist_ok=True)

    for rel, content in FILES.items():
        path = repo / rel
        path.parent.mkdir(parents=True, exist_ok=True)
        path.write_text(content, encoding='utf-8')
    print(f"[OK] formatted {len(FILES)} files")

if __name__ == '__main__':
    main()
